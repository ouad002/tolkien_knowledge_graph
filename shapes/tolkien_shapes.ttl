@prefix sh: <http://www.w3.org/ns/shacl#> .
@prefix tgo: <http://tolkiengateway.net/kg/ontology/> .
@prefix tg: <http://tolkiengateway.net/kg/resource/> .
@prefix schema: <http://schema.org/> .
@prefix xsd: <http://www.w3.org/2001/XMLSchema#> .
@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
@prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix dcterms: <http://purl.org/dc/terms/> .

# ============================================================
# CHARACTER SHAPES
# ============================================================

tgo:CharacterShape
    a sh:NodeShape ;
    sh:targetClass schema:Person ;
    sh:name "Character Validation Shape" ;
    sh:description "Validates Tolkien characters" ;
    
    sh:property [
        sh:path rdfs:label ;
        sh:minCount 1 ;
        sh:severity sh:Violation ;
        sh:message "Character must have an rdfs:label" ;
    ] ;
    
    sh:property [
        sh:path schema:name ;
        sh:maxCount 1 ;
        sh:severity sh:Warning ;
        sh:message "Character should have a schema:name" ;
    ] ;
    
    sh:property [
        sh:path schema:gender ;
        sh:maxCount 1 ;
        sh:severity sh:Info ;
        sh:message "Gender may be specified if known" ;
    ] ;
    
    sh:property [
        sh:path tgo:people ;
        sh:severity sh:Warning ;
        sh:message "Character should have a race or people" ;
    ] ;
    
    sh:property [
        sh:path schema:birthDate ;
        sh:maxCount 1 ;
        sh:severity sh:Violation ;
        sh:message "Character can have at most one birth date" ;
    ] ;
    
    sh:property [
        sh:path schema:deathDate ;
        sh:maxCount 1 ;
        sh:severity sh:Violation ;
        sh:message "Character can have at most one death date" ;
    ] .

# ============================================================
# PLACE SHAPES
# ============================================================

tgo:PlaceShape
    a sh:NodeShape ;
    sh:targetClass schema:Place ;
    sh:name "Place Validation Shape" ;
    sh:description "Validates geographical locations" ;
    
    sh:property [
        sh:path rdfs:label ;
        sh:minCount 1 ;
        sh:severity sh:Violation ;
        sh:message "Place must have an rdfs:label" ;
    ] ;
    
    sh:property [
        sh:path schema:name ;
        sh:maxCount 1 ;
        sh:severity sh:Warning ;
        sh:message "Place should have a schema:name" ;
    ] ;
    
    sh:property [
        sh:path schema:additionalType ;
        sh:severity sh:Info ;
        sh:message "Place may have a type" ;
    ] ;
    
    sh:property [
        sh:path schema:containedInPlace ;
        sh:nodeKind sh:IRI ;
        sh:severity sh:Info ;
        sh:message "Place may be contained in another place" ;
    ] .

# ============================================================
# GENERIC ENTITY SHAPES
# ============================================================

tgo:ThingShape
    a sh:NodeShape ;
    sh:targetClass schema:Thing ;
    sh:name "Generic Entity Validation" ;
    sh:description "Minimal validation for unclassified entities" ;
    
    sh:property [
        sh:path rdfs:label ;
        sh:minCount 1 ;
        sh:severity sh:Violation ;
        sh:message "Entity must have an rdfs:label" ;
    ] ;
    
    sh:property [
        sh:path dcterms:source ;
        sh:minCount 1 ;
        sh:severity sh:Warning ;
        sh:message "Entity should cite its source" ;
    ] .

# ============================================================
# ENTITY INTEGRITY
# ============================================================

tgo:EntityIntegrityShape
    a sh:NodeShape ;
    sh:targetSubjectsOf rdfs:label ;
    sh:name "Entity Integrity Validation" ;
    
    sh:property [
        sh:path rdf:type ;
        sh:minCount 1 ;
        sh:severity sh:Violation ;
        sh:message "Entity must have at least one rdf:type" ;
    ] .

# ============================================================
# RELATIONSHIP CONSTRAINTS
# ============================================================

tgo:ParentageIntegrityShape
    a sh:NodeShape ;
    sh:targetSubjectsOf tgo:parentage ;
    sh:name "Parentage Validation" ;
    
    sh:property [
        sh:path tgo:parentage ;
        sh:nodeKind sh:IRI ;
        sh:severity sh:Warning ;
        sh:message "Parentage should reference an entity URI" ;
    ] .

tgo:AffiliationIntegrityShape
    a sh:NodeShape ;
    sh:targetSubjectsOf tgo:affiliation ;
    sh:name "Affiliation Validation" ;
    
    sh:property [
        sh:path tgo:affiliation ;
        sh:nodeKind sh:IRI ;
        sh:severity sh:Warning ;
        sh:message "Affiliation should reference an entity URI" ;
    ] .

tgo:LocationIntegrityShape
    a sh:NodeShape ;
    sh:targetSubjectsOf tgo:location ;
    sh:name "Location Reference Validation" ;
    
    sh:property [
        sh:path tgo:location ;
        sh:nodeKind sh:IRI ;
        sh:severity sh:Warning ;
        sh:message "Location should reference an entity URI" ;
    ] .

# ============================================================
# LANGUAGE TAG VALIDATION
# ============================================================

tgo:LanguageTagShape
    a sh:NodeShape ;
    sh:targetSubjectsOf rdfs:label ;
    sh:name "Language Tag Validation" ;
    
    sh:property [
        sh:path rdfs:label ;
        sh:languageIn ("en") ;
        sh:severity sh:Warning ;
        sh:message "Labels should have language tags" ;
    ] .

# ============================================================
# SOURCE ATTRIBUTION
# ============================================================

tgo:SourceAttributionShape
    a sh:NodeShape ;
    sh:targetClass schema:Person, schema:Place, schema:Event ;
    sh:name "Source Attribution Validation" ;
    sh:description "Ensures traceability of entities" ;
    
    sh:property [
        sh:path dcterms:source ;
        sh:minCount 1 ;
        sh:nodeKind sh:IRI ;
        sh:severity sh:Warning ;
        sh:message "Entity should have a source attribution" ;
    ] .
